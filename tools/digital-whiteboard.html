<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digital Whiteboard - Ultimate Student Toolkit</title>
    <meta name="description" content="Create visual diagrams and study materials with our free online Digital Whiteboard tool. Perfect for brainstorming, teaching, and collaborative learning.">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/build/three.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="../css/style.css">
    <!-- Fabric.js for canvas drawing -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.1/fabric.min.js"></script>
</head>
<body class="bg-gradient-to-r from-indigo-100 via-purple-100 to-pink-100 min-h-screen">
    <!-- 3D Animation Container -->
    <div id="animation-container" class="fixed top-0 left-0 w-full h-full pointer-events-none z-0"></div>

    <!-- Header -->
    <header class="relative z-10 bg-white bg-opacity-80 shadow-lg">
        <div class="container mx-auto px-4 py-6">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="flex items-center mb-4 md:mb-0">
                    <div id="logo-container" class="w-16 h-16 mr-3 relative animate-float"></div>
                    <a href="../index.html" class="text-3xl md:text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-purple-600 via-pink-500 to-indigo-600">Ultimate Student Toolkit</a>
                </div>
                <nav class="flex space-x-1 md:space-x-4">
                    <a href="../index.html" class="px-3 py-2 text-sm md:text-base rounded-lg bg-white text-gray-700 hover:bg-gray-100 transition duration-300">Home</a>
                    <a href="../about.html" class="px-3 py-2 text-sm md:text-base rounded-lg bg-white text-gray-700 hover:bg-gray-100 transition duration-300">About</a>
                    <a href="../contact.html" class="px-3 py-2 text-sm md:text-base rounded-lg bg-white text-gray-700 hover:bg-gray-100 transition duration-300">Contact</a>
                    <a href="../privacy.html" class="px-3 py-2 text-sm md:text-base rounded-lg bg-white text-gray-700 hover:bg-gray-100 transition duration-300">Privacy Policy</a>
                </nav>
            </div>
        </div>
    </header>

    <!-- Tool Content -->
    <section class="relative z-10 py-12">
        <div class="container mx-auto px-4">
            <div class="tool-container animate-fade-in">
                <div class="tool-header text-center">
                    <h1 class="text-3xl md:text-4xl font-bold mb-4 gradient-text">Digital Whiteboard</h1>
                    <p class="text-lg text-gray-600">Create visual diagrams and study materials</p>
                </div>
                
                <!-- Tool Description -->
                <div class="bg-white p-6 rounded-xl shadow-lg mb-8">
                    <h2 class="text-2xl font-semibold mb-4 text-gray-800">About This Tool</h2>
                    <p class="text-gray-700 mb-4">The Digital Whiteboard is a versatile drawing and diagramming tool designed for visual learning, teaching, and collaboration. It provides a blank canvas where students and educators can create diagrams, illustrations, mind maps, and other visual content to enhance understanding and communication of complex concepts.</p>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-6">
                        <div>
                            <h3 class="text-xl font-semibold mb-3 text-gray-800">Key Features</h3>
                            <ul class="list-disc pl-5 space-y-2 text-gray-700">
                                <li>Multiple drawing tools including pen, shapes, lines, and text</li>
                                <li>Customizable colors and brush sizes for precise control</li>
                                <li>Selection and manipulation tools to edit existing elements</li>
                                <li>Eraser functionality for easy corrections</li>
                                <li>Export and save options to preserve your work</li>
                            </ul>
                        </div>
                        <div>
                            <h3 class="text-xl font-semibold mb-3 text-gray-800">How It Helps</h3>
                            <ul class="list-disc pl-5 space-y-2 text-gray-700">
                                <li>Facilitates visual explanation of complex concepts</li>
                                <li>Supports different learning styles, especially visual learners</li>
                                <li>Enables creation of custom study materials and diagrams</li>
                                <li>Provides a platform for brainstorming and idea development</li>
                                <li>Helps illustrate processes, relationships, and structures</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                 
                <!-- FAQs -->
                <div class="bg-white p-6 rounded-xl shadow-lg mb-8">
                    <h2 class="text-2xl font-semibold mb-4 text-gray-800">Frequently Asked Questions</h2>
                    
                    <div class="space-y-4">
                        <div>
                            <h3 class="text-xl font-semibold mb-2 text-gray-800">Can I use the Digital Whiteboard on mobile devices?</h3>
                            <p class="text-gray-700">Yes, the Digital Whiteboard is responsive and works on mobile devices, though a larger screen provides more drawing space and precision. For complex diagrams, we recommend using a tablet or desktop computer.</p>
                        </div>
                        
                        <div>
                            <h3 class="text-xl font-semibold mb-2 text-gray-800">How can I undo a mistake?</h3>
                            <p class="text-gray-700">You can use the undo button in the toolbar to reverse your most recent actions. For more specific corrections, you can use the eraser tool or select and delete individual elements.</p>
                        </div>
                        
                        <div>
                            <h3 class="text-xl font-semibold mb-2 text-gray-800">What's the best way to create a diagram for a science project?</h3>
                            <p class="text-gray-700">Start with a clear layout plan. Use shapes for key components, connect them with lines to show relationships, and add text labels for clarity. Use colors consistently to categorize different elements or processes, and keep your design clean and uncluttered.</p>
                        </div>
                        
                        <div>
                            <h3 class="text-xl font-semibold mb-2 text-gray-800">Can I import images to my whiteboard?</h3>
                            <p class="text-gray-700">The current version doesn't support direct image imports. However, you can reference external images while creating your diagrams. We're planning to add image import functionality in a future update.</p>
                        </div>
                        
                        <div>
                            <h3 class="text-xl font-semibold mb-2 text-gray-800">How do I share my whiteboard with my study group?</h3>
                            <p class="text-gray-700">After creating your whiteboard content, use the export function to save it as an image. You can then share this image through email, messaging apps, or include it in shared documents for your study group to reference.</p>
                        </div>
                    </div>
                </div>
                
                <!-- Digital Whiteboard App -->
                <div class="my-8">
                    <div class="bg-white p-6 rounded-xl shadow-lg">
                        <!-- Toolbar -->
                        <div class="flex flex-wrap gap-2 mb-4 p-2 bg-gray-50 rounded-lg border border-gray-200">
                            <!-- Drawing Tools -->
                            <div class="flex items-center space-x-1 pr-2 border-r border-gray-300">
                                <button id="select-tool" class="tool-btn active-tool p-2 rounded-md hover:bg-gray-200 transition duration-300" title="Select">
                                    <i class="fas fa-mouse-pointer text-gray-700"></i>
                                </button>
                                <button id="draw-tool" class="tool-btn p-2 rounded-md hover:bg-gray-200 transition duration-300" title="Free Draw">
                                    <i class="fas fa-pencil text-gray-700"></i>
                                </button>
                                <button id="line-tool" class="tool-btn p-2 rounded-md hover:bg-gray-200 transition duration-300" title="Line">
                                    <i class="fas fa-slash text-gray-700"></i>
                                </button>
                                <button id="rect-tool" class="tool-btn p-2 rounded-md hover:bg-gray-200 transition duration-300" title="Rectangle">
                                    <i class="far fa-square text-gray-700"></i>
                                </button>
                                <button id="circle-tool" class="tool-btn p-2 rounded-md hover:bg-gray-200 transition duration-300" title="Circle">
                                    <i class="far fa-circle text-gray-700"></i>
                                </button>
                                <button id="text-tool" class="tool-btn p-2 rounded-md hover:bg-gray-200 transition duration-300" title="Text">
                                    <i class="fas fa-font text-gray-700"></i>
                                </button>
                                <button id="eraser-tool" class="tool-btn p-2 rounded-md hover:bg-gray-200 transition duration-300" title="Eraser">
                                    <i class="fas fa-eraser text-gray-700"></i>
                                </button>
                            </div>
                            
                            <!-- Color Picker -->
                            <div class="flex items-center space-x-1 px-2 border-r border-gray-300">
                                <span class="text-sm text-gray-700">Color:</span>
                                <input type="color" id="color-picker" value="#000000" class="w-8 h-8 rounded cursor-pointer">
                                <div class="flex space-x-1">
                                    <div class="color-swatch bg-black w-6 h-6 rounded-full cursor-pointer border border-gray-300" data-color="#000000"></div>
                                    <div class="color-swatch bg-red-500 w-6 h-6 rounded-full cursor-pointer border border-gray-300" data-color="#ef4444"></div>
                                    <div class="color-swatch bg-blue-500 w-6 h-6 rounded-full cursor-pointer border border-gray-300" data-color="#3b82f6"></div>
                                    <div class="color-swatch bg-green-500 w-6 h-6 rounded-full cursor-pointer border border-gray-300" data-color="#22c55e"></div>
                                    <div class="color-swatch bg-yellow-500 w-6 h-6 rounded-full cursor-pointer border border-gray-300" data-color="#eab308"></div>
                                    <div class="color-swatch bg-purple-500 w-6 h-6 rounded-full cursor-pointer border border-gray-300" data-color="#a855f7"></div>
                                </div>
                            </div>
                            
                            <!-- Brush Size -->
                            <div class="flex items-center space-x-1 px-2 border-r border-gray-300">
                                <span class="text-sm text-gray-700">Size:</span>
                                <input type="range" id="brush-size" min="1" max="50" value="5" class="w-24">
                                <span id="size-display" class="text-sm text-gray-700 w-6 text-center">5</span>
                            </div>
                            
                            <!-- Canvas Actions -->
                            <div class="flex items-center space-x-1 px-2">
                                <button id="clear-canvas" class="p-2 rounded-md hover:bg-gray-200 transition duration-300" title="Clear Canvas">
                                    <i class="fas fa-trash-alt text-gray-700"></i>
                                </button>
                                <button id="undo-action" class="p-2 rounded-md hover:bg-gray-200 transition duration-300" title="Undo">
                                    <i class="fas fa-undo text-gray-700"></i>
                                </button>
                                <button id="redo-action" class="p-2 rounded-md hover:bg-gray-200 transition duration-300" title="Redo">
                                    <i class="fas fa-redo text-gray-700"></i>
                                </button>
                                <button id="save-canvas" class="p-2 rounded-md hover:bg-gray-200 transition duration-300" title="Save as Image">
                                    <i class="fas fa-download text-gray-700"></i>
                                </button>
                            </div>
                        </div>
                        
                        <!-- Canvas Container -->
                        <div class="relative bg-white border border-gray-200 rounded-lg overflow-hidden" style="height: 500px;">
                            <canvas id="whiteboard-canvas" class="w-full h-full"></canvas>
                            
                            <!-- Initial Instructions -->
                            <div id="initial-instructions" class="absolute inset-0 flex items-center justify-center bg-white bg-opacity-90">
                                <div class="text-center p-6 max-w-md">
                                    <div class="w-16 h-16 mx-auto mb-4 rounded-full bg-fuchsia-100 flex items-center justify-center">
                                        <i class="fas fa-chalkboard text-fuchsia-600 text-2xl"></i>
                                    </div>
                                    <h3 class="text-xl font-semibold text-gray-800 mb-2">Start Creating</h3>
                                    <p class="text-gray-600 mb-4">Use the toolbar above to draw, add shapes, and create your visual study materials.</p>
                                    <button id="start-drawing-btn" class="px-4 py-2 bg-gradient-to-r from-fuchsia-500 to-violet-600 text-white rounded-md hover:from-fuchsia-600 hover:to-violet-700 transition duration-300">
                                        <i class="fas fa-play mr-2"></i>Start Drawing
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Text Editor (Hidden by default) -->
                        <div id="text-editor" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50 hidden">
                            <div class="bg-white p-4 rounded-lg shadow-lg w-full max-w-md">
                                <h3 class="text-lg font-semibold text-gray-800 mb-3">Add Text</h3>
                                <textarea id="text-input" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-fuchsia-500 focus:border-fuchsia-500 mb-3" rows="3" placeholder="Enter your text here..."></textarea>
                                <div class="flex justify-between">
                                    <select id="font-family" class="px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-fuchsia-500 focus:border-fuchsia-500">
                                        <option value="Arial">Arial</option>
                                        <option value="Times New Roman">Times New Roman</option>
                                        <option value="Courier New">Courier New</option>
                                        <option value="Georgia">Georgia</option>
                                        <option value="Verdana">Verdana</option>
                                    </select>
                                    <select id="font-size" class="px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-fuchsia-500 focus:border-fuchsia-500">
                                        <option value="12">12px</option>
                                        <option value="16">16px</option>
                                        <option value="20" selected>20px</option>
                                        <option value="24">24px</option>
                                        <option value="32">32px</option>
                                        <option value="48">48px</option>
                                    </select>
                                </div>
                                <div class="flex justify-end mt-3 space-x-2">
                                    <button id="cancel-text" class="px-3 py-1 bg-white border border-gray-300 text-gray-700 rounded-md hover:bg-gray-100 transition duration-300">
                                        Cancel
                                    </button>
                                    <button id="add-text" class="px-3 py-1 bg-gradient-to-r from-fuchsia-500 to-violet-600 text-white rounded-md hover:from-fuchsia-600 hover:to-violet-700 transition duration-300">
                                        Add Text
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Tips Section -->
                        <div class="mt-6 p-4 bg-fuchsia-50 rounded-lg">
                            <h3 class="text-lg font-semibold text-gray-800 mb-2">Whiteboard Tips</h3>
                            <ul class="text-gray-700 space-y-2">
                                <li><i class="fas fa-check-circle text-fuchsia-600 mr-2"></i>Use different colors to highlight important concepts</li>
                                <li><i class="fas fa-check-circle text-fuchsia-600 mr-2"></i>Create diagrams with shapes and connecting lines</li>
                                <li><i class="fas fa-check-circle text-fuchsia-600 mr-2"></i>Add text labels to explain your visual elements</li>
                                <li><i class="fas fa-check-circle text-fuchsia-600 mr-2"></i>Save your work as an image to review later</li>
                                <li><i class="fas fa-check-circle text-fuchsia-600 mr-2"></i>Clear the canvas when you want to start fresh</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-white bg-opacity-90 py-8 relative z-10">
        <div class="container mx-auto px-4">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="mb-4 md:mb-0">
                    <p class="text-gray-600">&copy; <span id="current-year">2025</span> Ultimate Student Toolkit. All rights reserved.</p>
                </div>
                <div class="flex space-x-4">
                    <a href="../about.html" class="text-gray-600 hover:text-purple-600 transition duration-300">About</a>
                    <a href="../contact.html" class="text-gray-600 hover:text-purple-600 transition duration-300">Contact</a>
                    <a href="../privacy.html" class="text-gray-600 hover:text-purple-600 transition duration-300">Privacy Policy</a>
                </div>
            </div>
        </div>
    </footer>

    <!-- JavaScript -->
    <script src="../js/animation.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Set current year in footer
            document.getElementById('current-year').textContent = new Date().getFullYear();
            
            // DOM Elements
            const canvas = document.getElementById('whiteboard-canvas');
            const colorPicker = document.getElementById('color-picker');
            const brushSize = document.getElementById('brush-size');
            const sizeDisplay = document.getElementById('size-display');
            const clearCanvasBtn = document.getElementById('clear-canvas');
            const undoBtn = document.getElementById('undo-action');
            const redoBtn = document.getElementById('redo-action');
            const saveCanvasBtn = document.getElementById('save-canvas');
            const toolButtons = document.querySelectorAll('.tool-btn');
            const colorSwatches = document.querySelectorAll('.color-swatch');
            const textEditor = document.getElementById('text-editor');
            const textInput = document.getElementById('text-input');
            const fontFamily = document.getElementById('font-family');
            const fontSize = document.getElementById('font-size');
            const addTextBtn = document.getElementById('add-text');
            const cancelTextBtn = document.getElementById('cancel-text');
            const initialInstructions = document.getElementById('initial-instructions');
            const startDrawingBtn = document.getElementById('start-drawing-btn');
            
            // Initialize Fabric.js canvas
            const fabricCanvas = new fabric.Canvas('whiteboard-canvas', {
                isDrawingMode: false,
                width: canvas.parentElement.clientWidth,
                height: canvas.parentElement.clientHeight,
                backgroundColor: '#ffffff'
            });
            
            // History for undo/redo
            let history = [];
            let historyIndex = -1;
            let isRedoing = false;
            
            // Current tool and settings
            let currentTool = 'select';
            let currentColor = '#000000';
            let currentSize = 5;
            let isDrawing = false;
            let startX, startY;
            let tempShape = null;
            
            // Initialize brush
            fabricCanvas.freeDrawingBrush.color = currentColor;
            fabricCanvas.freeDrawingBrush.width = currentSize;
            
            // Update size display
            brushSize.addEventListener('input', () => {
                currentSize = parseInt(brushSize.value);
                sizeDisplay.textContent = currentSize;
                fabricCanvas.freeDrawingBrush.width = currentSize;
            });
            
            // Color picker change
            colorPicker.addEventListener('input', () => {
                currentColor = colorPicker.value;
                fabricCanvas.freeDrawingBrush.color = currentColor;
            });
            
            // Color swatches
            colorSwatches.forEach(swatch => {
                swatch.addEventListener('click', () => {
                    currentColor = swatch.dataset.color;
                    colorPicker.value = currentColor;
                    fabricCanvas.freeDrawingBrush.color = currentColor;
                });
            });
            
            // Tool selection
            toolButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    // Remove active class from all tools
                    toolButtons.forEach(b => b.classList.remove('active-tool', 'bg-gray-200'));
                    
                    // Add active class to selected tool
                    btn.classList.add('active-tool', 'bg-gray-200');
                    
                    // Set current tool
                    const toolId = btn.id.split('-')[0];
                    setActiveTool(toolId);
                });
            });
            
            // Set active tool
            function setActiveTool(tool) {
                currentTool = tool;
                
                // Set drawing mode for pencil and eraser
                if (tool === 'draw') {
                    fabricCanvas.isDrawingMode = true;
                    fabricCanvas.freeDrawingBrush.color = currentColor;
                } else if (tool === 'eraser') {
                    fabricCanvas.isDrawingMode = true;
                    fabricCanvas.freeDrawingBrush.color = '#ffffff';
                } else {
                    fabricCanvas.isDrawingMode = false;
                }
                
                // Show text editor for text tool
                if (tool === 'text') {
                    textEditor.classList.remove('hidden');
                }
            }
            
            // Mouse down event
            fabricCanvas.on('mouse:down', (options) => {
                if (fabricCanvas.isDrawingMode) return;
                
                isDrawing = true;
                const pointer = fabricCanvas.getPointer(options.e);
                startX = pointer.x;
                startY = pointer.y;
                
                // Create shapes based on current tool
                if (currentTool === 'line') {
                    tempShape = new fabric.Line([startX, startY, startX, startY], {
                        stroke: currentColor,
                        strokeWidth: currentSize,
                        selectable: true
                    });
                    fabricCanvas.add(tempShape);
                } else if (currentTool === 'rect') {
                    tempShape = new fabric.Rect({
                        left: startX,
                        top: startY,
                        width: 0,
                        height: 0,
                        fill: 'transparent',
                        stroke: currentColor,
                        strokeWidth: currentSize,
                        selectable: true
                    });
                    fabricCanvas.add(tempShape);
                } else if (currentTool === 'circle') {
                    tempShape = new fabric.Circle({
                        left: startX,
                        top: startY,
                        radius: 0,
                        fill: 'transparent',
                        stroke: currentColor,
                        strokeWidth: currentSize,
                        selectable: true
                    });
                    fabricCanvas.add(tempShape);
                }
            });
            
            // Mouse move event
            fabricCanvas.on('mouse:move', (options) => {
                if (!isDrawing || fabricCanvas.isDrawingMode) return;
                
                const pointer = fabricCanvas.getPointer(options.e);
                
                // Update shapes based on current tool
                if (currentTool === 'line' && tempShape) {
                    tempShape.set({
                        x2: pointer.x,
                        y2: pointer.y
                    });
                } else if (currentTool === 'rect' && tempShape) {
                    if (pointer.x > startX) {
                        tempShape.set({
                            width: pointer.x - startX
                        });
                    } else {
                        tempShape.set({
                            left: pointer.x,
                            width: startX - pointer.x
                        });
                    }
                    
                    if (pointer.y > startY) {
                        tempShape.set({
                            height: pointer.y - startY
                        });
                    } else {
                        tempShape.set({
                            top: pointer.y,
                            height: startY - pointer.y
                        });
                    }
                } else if (currentTool === 'circle' && tempShape) {
                    const radius = Math.sqrt(Math.pow(pointer.x - startX, 2) + Math.pow(pointer.y - startY, 2)) / 2;
                    const centerX = (startX + pointer.x) / 2;
                    const centerY = (startY + pointer.y) / 2;
                    
                    tempShape.set({
                        left: centerX - radius,
                        top: centerY - radius,
                        radius: radius
                    });
                }
                
                fabricCanvas.renderAll();
            });
            
            // Mouse up event
            fabricCanvas.on('mouse:up', () => {
                if (fabricCanvas.isDrawingMode) {
                    saveCanvasState();
                    return;
                }
                
                isDrawing = false;
                
                if (tempShape) {
                    // Add the shape to history
                    saveCanvasState();
                    tempShape = null;
                }
            });
            
            // Object added event
            fabricCanvas.on('object:added', (e) => {
                if (!isRedoing && e.target !== tempShape) {
                    // Clear redo stack
                    history = history.slice(0, historyIndex + 1);
                }
            });
            
            // Add text to canvas
            addTextBtn.addEventListener('click', () => {
                const text = textInput.value.trim();
                if (!text) return;
                
                const textObj = new fabric.Text(text, {
                    left: fabricCanvas.width / 2,
                    top: fabricCanvas.height / 2,
                    fontFamily: fontFamily.value,
                    fontSize: parseInt(fontSize.value),
                    fill: currentColor,
                    originX: 'center',
                    originY: 'center',
                    selectable: true
                });
                
                fabricCanvas.add(textObj);
                fabricCanvas.setActiveObject(textObj);
                saveCanvasState();
                
                // Reset and hide text editor
                textInput.value = '';
                textEditor.classList.add('hidden');
            });
            
            // Cancel text addition
            cancelTextBtn.addEventListener('click', () => {
                textInput.value = '';
                textEditor.classList.add('hidden');
            });
            
            // Clear canvas
            clearCanvasBtn.addEventListener('click', () => {
                if (confirm('Are you sure you want to clear the canvas? This action cannot be undone.')) {
                    fabricCanvas.clear();
                    fabricCanvas.backgroundColor = '#ffffff';
                    fabricCanvas.renderAll();
                    saveCanvasState();
                }
            });
            
            // Undo action
            undoBtn.addEventListener('click', () => {
                if (historyIndex > 0) {
                    historyIndex--;
                    isRedoing = true;
                    fabricCanvas.loadFromJSON(history[historyIndex], () => {
                        fabricCanvas.renderAll();
                        isRedoing = false;
                    });
                }
            });
            
            // Redo action
            redoBtn.addEventListener('click', () => {
                if (historyIndex < history.length - 1) {
                    historyIndex++;
                    isRedoing = true;
                    fabricCanvas.loadFromJSON(history[historyIndex], () => {
                        fabricCanvas.renderAll();
                        isRedoing = false;
                    });
                }
            });
            
            // Save canvas as image
            saveCanvasBtn.addEventListener('click', () => {
                const dataURL = fabricCanvas.toDataURL({
                    format: 'png',
                    quality: 1
                });
                
                const link = document.createElement('a');
                link.href = dataURL;
                link.download = 'whiteboard.png';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            });
            
            // Save canvas state for undo/redo
            function saveCanvasState() {
                // Don't save if we're in the middle of redoing
                if (isRedoing) return;
                
                // Get current canvas state
                const json = JSON.stringify(fabricCanvas);
                
                // Clear redo stack
                history = history.slice(0, historyIndex + 1);
                
                // Add current state to history
                history.push(json);
                historyIndex++;
            }
            
            // Handle window resize
            window.addEventListener('resize', () => {
                fabricCanvas.setWidth(canvas.parentElement.clientWidth);
                fabricCanvas.setHeight(canvas.parentElement.clientHeight);
                fabricCanvas.renderAll();
            });
            
            // Start drawing button
            startDrawingBtn.addEventListener('click', () => {
                initialInstructions.classList.add('hidden');
                // Save initial state
                saveCanvasState();
            });
            
            // Initialize with first state
            saveCanvasState();
        });
    </script>
</body>
</html>